<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-02-03">
<meta name="description" content="Bigger concepts for MS797 coursework">

<title>slinberg.net - Bigger Concepts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-0ZXRPNMLL7"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0ZXRPNMLL7', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
<meta name="twitter:title" content="slinberg.net - Bigger Concepts">
<meta name="twitter:description" content="Bigger concepts for MS797 coursework">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">slinberg.net</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../../"><i class="bi bi-house" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../steve.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../academics.html">Academics</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/stevelinberg"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/slinberg/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stevelinberg"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://stackoverflow.com/users/13603796/stevelinberg"><i class="bi bi-stack-overflow" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:steve@slinberg.net"><i class="bi bi-envelope" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Bigger Concepts</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../academics/695M/index.html" class="sidebar-item-text sidebar-link">695M - Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/695M/glossary/index.html" class="sidebar-item-text sidebar-link">Glossary</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/695M/useful-r-tidbits/index.html" class="sidebar-item-text sidebar-link">Useful R tidbits: Machine Learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/695M/bigger-concepts/index.html" class="sidebar-item-text sidebar-link active">Bigger Concepts</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../academics/697E/index.html" class="sidebar-item-text sidebar-link">697E - Political Networks Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/glossary/index.html" class="sidebar-item-text sidebar-link">Glossary</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/useful-r-tidbits/index.html" class="sidebar-item-text sidebar-link">Useful R tidbits: Political Networks Analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/697E-hw3/index.html" class="sidebar-item-text sidebar-link">Homework 3: The Florentine Wedding dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/697E-hw4/index.html" class="sidebar-item-text sidebar-link">Homework 4: Centrality Analysis of the Florentine Wedding dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/697E-hw5/index.html" class="sidebar-item-text sidebar-link">Homework 5: Constraint and Brokerage in the Florentine Wedding dataset</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../academics/697E/697E-hw6/index.html" class="sidebar-item-text sidebar-link">Homework 6: Clustering and Blockmodels in the Florentine Wedding dataset</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#classification" id="toc-classification" class="nav-link active" data-scroll-target="#classification">Classification</a>
  <ul class="collapse">
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#when-to-use-logistic-regression" id="toc-when-to-use-logistic-regression" class="nav-link" data-scroll-target="#when-to-use-logistic-regression">When to use logistic regression</a></li>
  <li><a href="#how-to-do-logistic-regression" id="toc-how-to-do-logistic-regression" class="nav-link" data-scroll-target="#how-to-do-logistic-regression">How to do logistic regression</a></li>
  </ul></li>
  <li><a href="#linear-discriminant-analysis-lda" id="toc-linear-discriminant-analysis-lda" class="nav-link" data-scroll-target="#linear-discriminant-analysis-lda">Linear Discriminant Analysis (LDA)</a></li>
  <li><a href="#resampling-methods" id="toc-resampling-methods" class="nav-link" data-scroll-target="#resampling-methods">Resampling methods</a>
  <ul class="collapse">
  <li><a href="#cross-validation-validation-set-approach" id="toc-cross-validation-validation-set-approach" class="nav-link" data-scroll-target="#cross-validation-validation-set-approach">Cross-validation: validation set approach</a></li>
  <li><a href="#cross-validation-leave-one-out-loocv" id="toc-cross-validation-leave-one-out-loocv" class="nav-link" data-scroll-target="#cross-validation-leave-one-out-loocv">Cross-validation: leave-one-out (LOOCV)</a></li>
  <li><a href="#cross-validation-k-fold" id="toc-cross-validation-k-fold" class="nav-link" data-scroll-target="#cross-validation-k-fold">Cross-validation: k-fold</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/stevelinberg/quarto-blog/edit/main/academics/695M/bigger-concepts/index.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/stevelinberg/quarto-blog/issues/new" class="toc-action">Report an issue</a></p><p><a href="https://github.com/stevelinberg/quarto-blog/blob/main/academics/695M/bigger-concepts/index.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Bigger Concepts</h1>
  <div class="quarto-categories">
    <div class="quarto-category">machine learning</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Bigger concepts for MS797 coursework</p>
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 3, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>This page is for concepts that don’t fit into the <a href="../../../academics/695M/glossary/index.html">glossary</a>.</p>
<p><strong>This document is in process.</strong></p>
<section id="classification" class="level1 page-columns page-full">
<h1>Classification</h1>
<p>The general umbrella categories for <em>classification</em>—where the outcome variable to be predicted is categorical, rather than continuous, like eye color rather than weight—are “discriminative” and “generative”. Discriminative models take sets of data and separate them into classes, like finding the decision boundary between two or more classes, but can’t predict the values of new data. Generative models (used in unsupervised learning) can generate new data, but are more susceptible to outliers (misclassified observations) than discriminative models, require more data to create, and are more computationally expensive.</p>
<p>A generative model—somehow—tries to guess how the data was generated, so it can take a new bit of unseen data, assess the probability that each class would have produced it, and pick the class with the highest probability.</p>
<p>A discriminative model can only look at existing data and create a decision boundary separating the existing data into classes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="disc-gen.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure from https://stanford.edu/%7Eshervine/teaching/cs-229/cheatsheet-supervised-learning</figcaption><p></p>
</figure>
</div>
<p>Note that there is no decision boundary in the generative model, just levels of probability into which new data could be classified with varying levels of confidence.</p>
<p>Logistic regression is discriminative. Linear discriminant analysis, quadratic discriminant analysis, and naive Bayes are generative, K-nearest neighbors appears to be neither.</p>
<section id="logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h2>
<p>Logistic regression’s output is a <em>probability</em> that a response variable belongs to a particular category.</p>
<p>The general form of a logistic model is:</p>
<p><span class="math display">\[p(X) = \text{PR}(Y = 1|X)\]</span> The right side of the equation reads “The probability that Y equals 1, given X” - or the chance that Y is a particular category for a specific value of X.</p>
<p>A linear regression model would use this form:</p>
<p><span class="math display">\[p(X) = \beta_0 + \beta_1X\]</span></p>
<p>And the magic formula for this is the <em>logistic function</em>, in which we raise <span class="math inline">\(e\)</span> to this power.</p>
<p><span class="math display">\[p(X) = \frac{e^{\beta_0 + \beta_1X}}{1 + e^{\beta_0 + \beta_1X}}\]</span></p>
<p>(Why <span class="math inline">\(e^{\beta_0 + \beta_1X}\)</span> instead of, say, <span class="math inline">\(2^{\beta_0 + \beta_1X}\)</span> or <span class="math inline">\(\pi^{\beta_0 + \beta_1X}\)</span> or <span class="math inline">\(123456^{\beta_0 + \beta_1X}\)</span>?)</p>
<p>Dividing both sides by <span class="math inline">\(1 - p(X)\)</span> (somehow) yields:</p>
<p><span class="math display">\[\frac{p(X)}{1 - p(X)} = e^{\beta_0 + \beta_1X}\]</span></p>
<p>which is also the <em>odds</em> that Y is 1 given X. If the probability of something is 20%, or 1/5, then the odds are 1/4:</p>
<p><span class="math display">\[\frac{1}{5} \div \left[ 1 - \frac{1}{5} \right] = \frac{1}{5} \div \frac{4}{5} = \frac{1}{5} \times \frac{5}{4} = 1/4 = 0.25\]</span></p>
<section id="when-to-use-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="when-to-use-logistic-regression">When to use logistic regression</h3>
<p>When the response variable is categorical, and has two possible classes, like “Yes” or “No”, “Up” or “Down”, etc. However, see Linear Discriminant Analysis below for examples of when <em>not</em> to use it.</p>
<p>In some cases, a categorical response variable could be analyzed with a linear regression by treating the categorical variable as numeric, like treating “not infected” as 0 and “infected” as 1, and using the rounded value as the predictor; however, beyond 2 possible responses it’s unlikely that a continuous scale could be established between the possible values, and it gets messy.</p>
</section>
<section id="how-to-do-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="how-to-do-logistic-regression">How to do logistic regression</h3>
<p>Use <code>glm()</code> with the argument <code>family = binomial</code> to indicate logistic regression.</p>
<p>Using the <code>Boston</code> data set from the <code>ISLR2</code> package, the following will model the probability of a tract having a <code>crim</code> rate above the median, based on <code>zn</code>, using logistic regression:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = crim_above_med ~ zn, family = binomial, data = boston)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.4319  -1.4319   0.4634   0.9427   1.8532  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  0.58076    0.10727   5.414 6.17e-08 ***
zn          -0.09545    0.01349  -7.075 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 701.46  on 505  degrees of freedom
Residual deviance: 559.53  on 504  degrees of freedom
AIC: 563.53

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>The <code>zn.fit</code> summary above will show the coefficients and p-values; the <code>$coef</code> aspect of the summary will show more detail.</p>
<p><code>predict()</code> can then be fed the fit to make predictions. The argument <code>type = "response"</code> will tell it to output probabilities “of the form <span class="math inline">\(P(Y = 1|X)\)</span>” from the data that was used in the fit, also described as the training data. It returns a vector of probabilities for every data element.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.2428</td>
<td style="text-align: center;">0.6412</td>
<td style="text-align: center;">0.6412</td>
<td style="text-align: center;">0.6412</td>
<td style="text-align: center;">0.6412</td>
<td style="text-align: center;">0.6412</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The responses can be converted into categories and turned into a confusion matrix to show how the regression did with the training data.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">No</th>
<th style="text-align: center;">Yes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>No</strong></td>
<td style="text-align: center;">119</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Yes</strong></td>
<td style="text-align: center;">134</td>
<td style="text-align: center;">238</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The overall success rate can be calculated with <code>mean()</code>, comparing each predicted value to the actual value:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7055336</code></pre>
</div>
</div>
<p>The model can then be run on test data that is held out from the main set, with the expectation that it won’t do quite as well as the training data. The efficacy can then be assessed in the same way, and if it’s not high, we can return to the model and try to find other forms that make better predictions - or perhaps conclude that we can’t make a good prediction at all.</p>
</section>
</section>
<section id="linear-discriminant-analysis-lda" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="linear-discriminant-analysis-lda">Linear Discriminant Analysis (LDA)</h2>
<p>The simplest use case for LDA is when there are more than two possible response classes; logistic regression gives the probability that an observation is in a class A or B, but it can only handle two classes.</p>
<p>LDA also gives better results when “there is substantial separation between the two classes”, or where the sample size is small and the distribution of the predictors is approximately normal in each of the classes.</p>
<aside>
How do we determine this?
</aside>
</section>
<section id="resampling-methods" class="level2">
<h2 class="anchored" data-anchor-id="resampling-methods">Resampling methods</h2>
<p>Resampling methods are used to refine and test models against training data by repeatedly testing against different subsets within the data.</p>
<p><em>Cross-validation</em> can be used to estimate the test error rate of a method (<em>model assessment</em>), and <em>bootstrap</em> is mostly to measure the accuracy of a parameter or of a method.</p>
<section id="cross-validation-validation-set-approach" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-validation-set-approach">Cross-validation: validation set approach</h3>
<p>This approach randomly splits the data into two sets: a <em>training</em> set and a <em>validation</em> or <em>test</em> set. Size ratios seem to be on the order of between 50-50 to 3:1 or 4:1 training-to-test data. The model is fit against the training data, and then <code>predict()</code> is used to predict the results for the validation data; the results of <code>predict</code> can then be compared against the actual classifications in the validation data to compute the error rate.</p>
<p>This process can be run repeatedly with different splits.</p>
<p>The general process is:</p>
<ol type="1">
<li>Randomly split the dataset into training and validation sets</li>
<li>Fit the model to the training data</li>
<li>Predict the outcomes of the model on the validation data</li>
<li>Convert the predictions into categorical variables that match the field being predicted (like Yes/No, etc)</li>
<li>The error rate is the proportion of correct predictions in the validation data.</li>
</ol>
<p>The code below runs 10 iterations and accumulates the results into a results data frame.</p>
<div class="cell">

</div>
</section>
<section id="cross-validation-leave-one-out-loocv" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-leave-one-out-loocv">Cross-validation: leave-one-out (LOOCV)</h3>
<p>This method is similar to the validation set approach, except that the validation set is only one element, and the training set is the remaining <span class="math inline">\(n-1\)</span> observations. It is run automatically <span class="math inline">\(n\)</span> times and returns an average of the test errors.</p>
<p>The process is simpler than the validation set approach:</p>
<ol type="1">
<li>Fit the model to the entire data set with <code>glm()</code> (omitting the <code>subset</code> argument)</li>
<li>Run <code>cv.glm</code> on the fit</li>
<li>The <code>delta</code> factor of the return data is the cross-validation error rate for the test data.</li>
</ol>
<p>Code from the book:</p>
<div class="cell">

</div>
</section>
<section id="cross-validation-k-fold" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-k-fold">Cross-validation: k-fold</h3>
<p>K-fold cross-validation is like leave-one-out cross-validation but with a larger test set; it splits the data up into <span class="math inline">\(k\)</span> segments and runs the cross-validation on each. It may give better results if run repeatedly and averaged, as with the validation set approach. It is faster than LOOCV, obviously, because it uses less data.</p>
<p>The process is the same as LOOCV, except a parameter such as <code>K = 10</code> is added to the <code>cv.glm()</code> call. 5 to 10 is a common range for values of <span class="math inline">\(k\)</span>.</p>
<!--
### When to use it

### How to do it

### How to interpret it
-->


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2022 Steve Linberg. Except where otherwise noted, all text and images licensed CC-BY-NC 4.0</div>   
  </div>
</footer>



</body></html>